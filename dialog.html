<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <title>送信確認</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; padding: 24px; }
    h1 { font-size: 16px; margin: 0 0 16px; }
    .row { display: flex; gap: 12px; }
    button { padding: 10px 16px; border-radius: 8px; border: 1px solid #ccc; cursor: pointer; }
    .primary { border-color: #0067c0; }
  </style>
</head>
<body>
  <h1>このメールを送信しますか？</h1>
  <div class="row">
    <button class="primary" id="sendBtn">送信</button>
    <button id="cancelBtn">キャンセル</button>
  </div>

  <script>
    Office.onReady(() => {
      const post = (msg) => Office.context.ui.messageParent(msg);

      document.getElementById('sendBtn').addEventListener('click', () => post('allow'));
      document.getElementById('cancelBtn').addEventListener('click', () => post('cancel'));

      // Esc キーでキャンセル相当
      window.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') post('cancel');
      });
    });
  </script>
</body>
</html>
